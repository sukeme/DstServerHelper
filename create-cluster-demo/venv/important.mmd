Mind Map generated by NB MindMap plugin   
> __version__=`1.1`,showJumps=`true`
---

# modid

## 检查id是否有效 9、10 位有效（应该）

### 有效

#### 检查mod是否在run

##### 不存在

###### 检查run队列是否满了

####### 没满

######## 加时间参数添加到run列表

######### 检查是否在数据库

########## 在，是旧 mod

########### 检查是否超过检查间隔

############ 没超检查间隔

############# 不修改数据库，从数据库获取modinfo作为结果
- TOPIC
<pre>17EF956B637A</pre>

############ 超过检查间隔

############# 用webapi获取mod类型与上次更新时间和文件地址

############## result1

############### 无更新

################ 从数据库获取modinfo作为结果
- TOPIC
<pre>17EF8805CCFA</pre>

############### 有更新
- TOPIC
<pre>17EF94BEF17A</pre>

############## 9
- TOPIC
<pre>17EF94DA08FA</pre>

############### mod 不存在

################ 数据库中删除mod

############## 15
- TOPIC
<pre>17EF94DAA90A</pre>

############### mod 存在但是没有查看权限

################ 更改mod类型

########## 不在，新 mod

########### 用webapi获取mod详情与上次更新时间和文件地址

############ result1

############# 通过creat、consumer id 判断是什么mod
> topicLinkUID=`17EF94BEF17A`


############## dst

############### v1
> topicLinkUID=`17EF86EFB7BA`


################ 通过file\_url下载modinfo
- TOPIC
<pre>17EF87742FBA</pre>

############### v2
> topicLinkUID=`17EF86F0CFBA`


################ 通过steamapi下载modinfo
> topicLinkUID=`17EF87742FBA`


################# 查无此mod，或大小为0。也可能是权限不足

################## 错误信息作为结果

################### 结果添加到数据库
> topicLinkUID=`17EF931A4AAA`


#################### 更新检查时间
> topicLinkUID=`17EF8805CCFA`


##################### 结果
> topicLinkUID=`17EF956B637A`


###################### 返回结果

###################### 检查run列表等待列 值

####################### 0

######################## 删除等待列

####################### 非0

######################## 结果添加到结果列

######################### 设定时任务，2秒后检查记录是否还存在，存在则删除

################# 下载成功但是mod没有modinfo

################## 无可显示项作为结果
- TOPIC
<pre>17EF8805CCFA</pre>

################# 下载失败
> topicLinkUID=`17EF936343AA`


################## 未知原因获取信息失败作为结果
- TOPIC
<pre>17EF8805CCFA</pre>

################# 下载成功
> topicLinkUID=`17EF936460AA`


################## 解析modinfo

################### 成功

#################### modinfo作为结果
- TOPIC
<pre>17EF931A4AAA</pre>

################### 失败

#################### 错误信息作为结果
- TOPIC
<pre>17EF931A4AAA</pre>

############## ds

############### 错误信息作为结果
- TOPIC
<pre>17EF8805CCFA</pre>

############## dst collect

############### 错误信息作为结果
- TOPIC
<pre>17EF8805CCFA</pre>

############## 其它app

############### 错误信息作为结果
- TOPIC
<pre>17EF8805CCFA</pre>

############ 9
> topicLinkUID=`17EF94DA08FA`


############# mod 不存在

############## 作为结果
- TOPIC
<pre>17EF8805CCFA</pre>

############ 15
> topicLinkUID=`17EF94DAA90A`


############# mod存在但是没有查看权限

############## 作为结果
- TOPIC
<pre>17EF8805CCFA</pre>

####### 满了

######## 检测是否在数据库中且不需要检查更新

######### 是

########## 获取modinfo作为结果
- TOPIC
<pre>17EF956B637A</pre>

######### 否

########## 返回服务器繁忙

##### 存在
> topicLinkUID=`17EF8544863A`


###### 在run列表对应等待列加1

####### 每秒检查结果列是否返回数据
> topicLinkUID=`17EF86CFCFAA`


######## 有结果

######### 根据结果返回

########## 检查等待列 值

########### 不为0，不管

########### 为0，删除run

######## 无结果
- TOPIC
<pre>17EF86CFCFAA</pre>

### 无效

#### 返回错误
